{"version":3,"sources":["functions.js"],"names":["_","Mavo","Functions","operators","$url","ret","url","URL","location","searchParams","pair","Object","defineProperty","value","get","obj","property","undefined","unique","arr","Set","sum","array","numbers","arguments","reduce","prev","current","average","length","min","Math","max","count","toArray","filter","a","round","num","decimals","isFinite","toLocaleString","useGrouping","maximumFractionDigits","iff","condition","iftrue","iffalse","Array","isArray","map","c","i","replace","haystack","needle","replacement","iterations","item","needleRegex","RegExp","escapeRegExp","counter","len","str","search","toLowerCase","indexOf","starts","ends","join","glue","idify","readable","identifier","$0","$1","$2","toUpperCase","uppercase","lowercase","$now","Date","year","getDateComponent","month","day","weekday","hour","hour12","minute","second","date","twodigit","time","minutes","floor","abs","seconds","hours","days","weeks","months","years","Script","addUnaryOperator","name","o","operand","scalar","addBinaryOperator","symbol","symbols","identity","code","operands","logical","result","b","n","slice","getOperatorName","op","isNaN","dateA","toDate","dateB","getNumericalOperands","p","r","da","db","details","aliases","subtract","multiply","divide","lt","gt","eq","split","forEach","alias","_Trap","self","Proxy","functions","propertyL","hasOwnProperty","has","args","$$","number","$","type","component","option","locale","document","documentElement","lang","format","options","extend","getDay","Number","shortname"],"mappings":";;;;;;;;AAAA;;;;AAIA,CAAC,YAAW;;AAEZ,KAAIA,IAAIC,KAAKC,SAAL,GAAiB;AACxBC,aAAW;AACV,QAAK;AADK,GADa;;AAKxB;AACAC,QAAO,YAAW;AACjB,OAAIC,MAAM,EAAV;AACA,OAAIC,MAAM,IAAIC,GAAJ,CAAQC,QAAR,CAAV;;AAFiB;AAAA;AAAA;;AAAA;AAIjB,yBAAiBF,IAAIG,YAArB,8HAAmC;AAAA,SAA1BC,IAA0B;;AAClCL,SAAIK,KAAK,CAAL,CAAJ,IAAeA,KAAK,CAAL,CAAf;AACA;AANgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAQjBC,UAAOC,cAAP,CAAsBP,GAAtB,EAA2B,UAA3B,EAAuC;AACtCQ,WAAO;AAAA,YAAM,IAAIN,GAAJ,CAAQC,QAAR,CAAN;AAAA;AAD+B,IAAvC;;AAIA,UAAOH,GAAP;AACA,GAbK,EANkB;;AAqBxB;;;AAGAS,OAAK,aAASC,GAAT,EAAcC,QAAd,EAAwB;AAC5B,UAAOD,OAAOA,IAAIC,QAAJ,MAAkBC,SAAzB,GAAoCF,IAAIC,QAAJ,CAApC,GAAoD,IAA3D;AACA,GA1BuB;;AA4BxBE,UAAQ,gBAASC,GAAT,EAAc;AACrB,uCAAW,IAAIC,GAAJ,CAAQD,GAAR,CAAX;AACA,GA9BuB;;AAgCxB;;;;AAIA;;;AAGAE,OAAK,aAASC,KAAT,EAAgB;AACpB,UAAOC,QAAQD,KAAR,EAAeE,SAAf,EAA0BC,MAA1B,CAAiC,UAACC,IAAD,EAAOC,OAAP,EAAmB;AAC1D,WAAO,CAACD,IAAD,IAAS,CAACC,OAAD,IAAY,CAArB,CAAP;AACA,IAFM,EAEJ,CAFI,CAAP;AAGA,GA3CuB;;AA6CxB;;;AAGAC,WAAS,iBAASN,KAAT,EAAgB;AACxBA,WAAQC,QAAQD,KAAR,EAAeE,SAAf,CAAR;;AAEA,UAAOF,MAAMO,MAAN,IAAgB7B,EAAEqB,GAAF,CAAMC,KAAN,IAAeA,MAAMO,MAA5C;AACA,GApDuB;;AAsDxB;;;AAGAC,OAAK,aAASR,KAAT,EAAgB;AACpB,UAAOS,KAAKD,GAAL,gCAAYP,QAAQD,KAAR,EAAeE,SAAf,CAAZ,EAAP;AACA,GA3DuB;;AA6DxB;;;AAGAQ,OAAK,aAASV,KAAT,EAAgB;AACpB,UAAOS,KAAKC,GAAL,gCAAYT,QAAQD,KAAR,EAAeE,SAAf,CAAZ,EAAP;AACA,GAlEuB;;AAoExBS,SAAO,eAASX,KAAT,EAAgB;AACtB,UAAOrB,KAAKiC,OAAL,CAAaZ,KAAb,EAAoBa,MAApB,CAA2B;AAAA,WAAKC,MAAM,IAAN,IAAcA,MAAM,KAApB,IAA6BA,MAAM,EAAxC;AAAA,IAA3B,EAAuEP,MAA9E;AACA,GAtEuB;;AAwExBQ,SAAO,eAASC,GAAT,EAAcC,QAAd,EAAwB;AAC9B,OAAI,CAACD,GAAD,IAAQ,CAACC,QAAT,IAAqB,CAACC,SAASF,GAAT,CAA1B,EAAyC;AACxC,WAAOP,KAAKM,KAAL,CAAWC,GAAX,CAAP;AACA;;AAED,UAAO,CAACA,IAAIG,cAAJ,CAAmB,OAAnB,EAA4B;AACnCC,iBAAa,KADsB;AAEnCC,2BAAuBJ;AAFY,IAA5B,CAAR;AAIA,GAjFuB;;AAmFxBK,OAAK,aAASC,SAAT,EAAoBC,MAApB,EAAwC;AAAA,OAAZC,OAAY,uEAAJ,EAAI;;AAC5C,OAAIC,MAAMC,OAAN,CAAcJ,SAAd,CAAJ,EAA8B;AAC7B,WAAOA,UAAUK,GAAV,CAAc,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAC9B,SAAI/C,MAAM8C,IAAGL,MAAH,GAAYC,OAAtB;;AAEA,SAAIC,MAAMC,OAAN,CAAc5C,GAAd,CAAJ,EAAwB;AACvB,aAAOA,IAAI0B,KAAKD,GAAL,CAASsB,CAAT,EAAY/C,IAAIwB,MAAJ,GAAa,CAAzB,CAAJ,CAAP;AACA;;AAED,YAAOxB,GAAP;AACA,KARM,CAAP;AASA;;AAED,UAAOwC,YAAWC,MAAX,GAAoBC,OAA3B;AACA,GAjGuB;;AAmGxB;;;;AAIA;;;AAGAM,WAAS,iBAASC,QAAT,EAAmBC,MAAnB,EAA6D;AAAA,OAAlCC,WAAkC,uEAApB,EAAoB;AAAA,OAAhBC,UAAgB,uEAAH,CAAG;;AACrE,OAAIT,MAAMC,OAAN,CAAcK,QAAd,CAAJ,EAA6B;AAC5B,WAAOA,SAASJ,GAAT,CAAa;AAAA,YAAQlD,EAAEqD,OAAF,CAAUK,IAAV,EAAgBH,MAAhB,EAAwBC,WAAxB,CAAR;AAAA,KAAb,CAAP;AACA;;AAED;AACA,OAAIG,cAAcC,OAAO3D,KAAK4D,YAAL,CAAkBN,MAAlB,CAAP,EAAkC,GAAlC,CAAlB;AACA,OAAIlD,MAAMiD,QAAV;AAAA,OAAoB5B,IAApB;AACA,OAAIoC,UAAU,CAAd;;AAEA,UAAOzD,OAAOqB,IAAP,IAAgBoC,YAAYL,UAAnC,EAAgD;AAC/C/B,WAAOrB,GAAP;AACAA,UAAMA,IAAIgD,OAAJ,CAAYM,WAAZ,EAAyBH,WAAzB,CAAN;AACA;;AAED,UAAOnD,GAAP;AACA,GA1HuB;;AA4HxB0D,OAAK;AAAA,UAAO,CAACC,OAAO,EAAR,EAAYnC,MAAnB;AAAA,GA5HmB;AA6HxB;;;AAGAoC,UAAQ,gBAACX,QAAD,EAAWC,MAAX;AAAA,UAAsBD,YAAYC,MAAZ,GAAoBD,SAASY,WAAT,GAAuBC,OAAvB,CAA+BZ,OAAOW,WAAP,EAA/B,CAApB,GAA2E,CAAC,CAAlG;AAAA,GAhIgB;;AAkIxBE,UAAQ,gBAACd,QAAD,EAAWC,MAAX;AAAA,UAAsBvD,EAAEiE,MAAF,CAASX,QAAT,EAAmBC,MAAnB,MAA+B,CAArD;AAAA,GAlIgB;AAmIxBc,QAAM,cAASf,QAAT,EAAmBC,MAAnB,EAA2B;AAChC,OAAIH,IAAIpD,EAAEiE,MAAF,CAASX,QAAT,EAAmBC,MAAnB,CAAR;AACA,UAAQH,IAAI,CAAC,CAAL,IAAUA,MAAME,SAASzB,MAAT,GAAkB0B,OAAO1B,MAAjD;AACA,GAtIuB;;AAwIxByC,QAAM,cAAShD,KAAT,EAA2B;AAAA,OAAXiD,IAAW,uEAAJ,EAAI;;AAChC,UAAOtE,KAAKiC,OAAL,CAAaZ,KAAb,EAAoBgD,IAApB,CAAyBC,IAAzB,CAAP;AACA,GA1IuB;;AA4IxBC,SAAO;AAAA,UAAY,CAAC,CAACC,YAAY,EAAb,IAAmB,EAApB,EACjBpB,OADiB,CACT,MADS,EACD,GADC,EACI;AADJ,IAEjBA,OAFiB,CAET,SAFS,EAEE,EAFF,EAEM;AAFN,IAGjBa,WAHiB,EAAZ;AAAA,GA5IiB;;AAiJxB;AACAO,YAAU,kBAAUC,UAAV,EAAsB;AAC/B;AACA,UAAOA,cAAcA,WACjBrB,OADiB,CACT,0BADS,EACmB,UAACsB,EAAD,EAAKC,EAAL,EAASC,EAAT;AAAA,WAAgBD,KAAK,GAAL,GAAWC,GAAGX,WAAH,EAA3B;AAAA,IADnB,EACgE;AADhE,IAEjBb,OAFiB,CAET,yBAFS,EAEkB,KAFlB,EAEyB;AAFzB,IAGjBA,OAHiB,CAGT,QAHS,EAGC;AAAA,WAAMsB,GAAGG,WAAH,EAAN;AAAA,IAHD,CAArB,CAF+B,CAKgB;AAC/C,GAxJuB;;AA0JxBC,aAAW;AAAA,UAAO,CAACf,MAAM,EAAP,EAAWc,WAAX,EAAP;AAAA,GA1Ja;AA2JxBE,aAAW;AAAA,UAAO,CAAChB,MAAM,EAAP,EAAWE,WAAX,EAAP;AAAA,GA3Ja;;AA6JxB;;;;AAIA,MAAIe,IAAJ,GAAW;AACV,UAAO,IAAIC,IAAJ,EAAP;AACA,GAnKuB;;AAqKxBC,QAAMC,iBAAiB,MAAjB,CArKkB;AAsKxBC,SAAOD,iBAAiB,OAAjB,CAtKiB;AAuKxBE,OAAKF,iBAAiB,KAAjB,CAvKmB;AAwKxBG,WAASH,iBAAiB,SAAjB,CAxKe;AAyKxBI,QAAMJ,iBAAiB,MAAjB,CAzKkB;AA0KxBK,UAAQL,iBAAiB,MAAjB,EAAyB,SAAzB,EAAoC,EAACK,QAAO,IAAR,EAApC,CA1KgB;AA2KxBC,UAAQN,iBAAiB,QAAjB,CA3KgB;AA4KxBO,UAAQP,iBAAiB,QAAjB,CA5KgB;;AA8KxBQ,QAAM,qBAAQ;AACb,UAAU5F,EAAEmF,IAAF,CAAOS,KAAP,CAAV,SAA0B5F,EAAEqF,KAAF,CAAQO,KAAR,EAAcC,QAAxC,SAAoD7F,EAAEsF,GAAF,CAAMM,KAAN,EAAYC,QAAhE;AACA,GAhLuB;AAiLxBC,QAAM,oBAAQ;AACb,UAAU9F,EAAEwF,IAAF,CAAOI,IAAP,EAAaC,QAAvB,SAAmC7F,EAAE0F,MAAF,CAASE,IAAT,EAAeC,QAAlD,SAA8D7F,EAAE2F,MAAF,CAASC,IAAT,EAAeC,QAA7E;AACA,GAnLuB;;AAqLxBE,WAAS;AAAA,UAAWhE,KAAKiE,KAAL,CAAWjE,KAAKkE,GAAL,CAASC,OAAT,IAAoB,EAA/B,CAAX;AAAA,GArLe;AAsLxBC,SAAO;AAAA,UAAWpE,KAAKiE,KAAL,CAAWjE,KAAKkE,GAAL,CAASC,OAAT,IAAoB,IAA/B,CAAX;AAAA,GAtLiB;AAuLxBE,QAAM;AAAA,UAAWrE,KAAKiE,KAAL,CAAWjE,KAAKkE,GAAL,CAASC,OAAT,IAAoB,KAA/B,CAAX;AAAA,GAvLkB;AAwLxBG,SAAO;AAAA,UAAWtE,KAAKiE,KAAL,CAAWjE,KAAKkE,GAAL,CAASC,OAAT,IAAoB,MAA/B,CAAX;AAAA,GAxLiB;AAyLxBI,UAAQ;AAAA,UAAWvE,KAAKiE,KAAL,CAAWjE,KAAKkE,GAAL,CAASC,OAAT,KAAqB,UAAU,KAA/B,CAAX,CAAX;AAAA,GAzLgB;AA0LxBK,SAAO;AAAA,UAAWxE,KAAKiE,KAAL,CAAWjE,KAAKkE,GAAL,CAASC,OAAT,KAAqB,UAAU,KAAV,GAAkB,EAAvC,CAAX,CAAX;AAAA;AA1LiB,EAAzB;;AA6LAjG,MAAKuG,MAAL,GAAc;AACbC,oBAAkB,0BAASC,IAAT,EAAeC,CAAf,EAAkB;AACnC,UAAO;AAAA,WAAW3D,MAAMC,OAAN,CAAc2D,OAAd,IAAwBA,QAAQ1D,GAAR,CAAYyD,EAAEE,MAAd,CAAxB,GAAgDF,EAAEE,MAAF,CAASD,OAAT,CAA3D;AAAA,IAAP;AACA,GAHY;;AAKb;;;;;;AAMAE,qBAAmB,2BAASJ,IAAT,EAAeC,CAAf,EAAkB;AACpC,OAAIA,EAAEI,MAAN,EAAc;AACb;AADa;AAAA;AAAA;;AAAA;AAEb,2BAAmB9G,KAAKiC,OAAL,CAAayE,EAAEI,MAAf,CAAnB,mIAA2C;AAAA,UAAlCA,MAAkC;;AAC1C9G,WAAKuG,MAAL,CAAYQ,OAAZ,CAAoBD,MAApB,IAA8BL,IAA9B;AACA;AAJY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKb;;AAEDC,KAAEM,QAAF,GAAaN,EAAEM,QAAF,KAAehG,SAAf,GAA0B,CAA1B,GAA8B0F,EAAEM,QAA7C;;AAEA,UAAOjH,EAAE0G,IAAF,IAAUC,EAAEO,IAAF,IAAU,YAAsB;AAAA,sCAAVC,QAAU;AAAVA,aAAU;AAAA;;AAChD,QAAIA,SAAStF,MAAT,KAAoB,CAAxB,EAA2B;AAC1B,SAAImB,MAAMC,OAAN,CAAckE,SAAS,CAAT,CAAd,CAAJ,EAAgC;AAC/B;AACAA,8CAAeA,SAAS,CAAT,CAAf;AACA;AACD;;AAED,QAAIzF,OAAOiF,EAAES,OAAF,GAAWT,EAAEM,QAAb,GAAwBE,SAAS,CAAT,CAAnC;AAAA,QAAgDE,MAAhD;;AARgD,+BAUvCjE,CAVuC;AAW/C,SAAIhB,IAAIuE,EAAES,OAAF,GAAWD,SAAS/D,IAAI,CAAb,CAAX,GAA6B1B,IAArC;AACA,SAAI4F,IAAIH,SAAS/D,CAAT,CAAR;;AAEA,SAAIJ,MAAMC,OAAN,CAAcqE,CAAd,CAAJ,EAAsB;AACrB,UAAI,OAAOX,EAAEM,QAAT,IAAqB,QAAzB,EAAmC;AAClCK,WAAI/F,QAAQ+F,CAAR,CAAJ;AACA;;AAED,UAAItE,MAAMC,OAAN,CAAcb,CAAd,CAAJ,EAAsB;AACrBiF,6CACIC,EAAEpE,GAAF,CAAM,UAACqE,CAAD,EAAInE,CAAJ;AAAA,eAAUuD,EAAEE,MAAF,CAASzE,EAAEgB,CAAF,MAASnC,SAAT,GAAoB0F,EAAEM,QAAtB,GAAiC7E,EAAEgB,CAAF,CAA1C,EAAgDmE,CAAhD,CAAV;AAAA,QAAN,CADJ,sBAEInF,EAAEoF,KAAF,CAAQF,EAAEzF,MAAV,CAFJ;AAIA,OALD,MAMK;AACJwF,gBAASC,EAAEpE,GAAF,CAAM;AAAA,eAAKyD,EAAEE,MAAF,CAASzE,CAAT,EAAYmF,CAAZ,CAAL;AAAA,QAAN,CAAT;AACA;AACD,MAdD,MAeK,IAAIvE,MAAMC,OAAN,CAAcb,CAAd,CAAJ,EAAsB;AAC1BiF,eAASjF,EAAEc,GAAF,CAAM;AAAA,cAAKyD,EAAEE,MAAF,CAASU,CAAT,EAAYD,CAAZ,CAAL;AAAA,OAAN,CAAT;AACA,MAFI,MAGA;AACJD,eAASV,EAAEE,MAAF,CAASzE,CAAT,EAAYkF,CAAZ,CAAT;AACA;;AAED,SAAIX,EAAElF,MAAN,EAAc;AACbC,aAAOiF,EAAElF,MAAF,CAASC,IAAT,EAAe2F,MAAf,EAAuBjF,CAAvB,EAA0BkF,CAA1B,CAAP;AACA,MAFD,MAGK,IAAIX,EAAES,OAAN,EAAe;AACnB1F,aAAOA,QAAQ2F,MAAf;AACA,MAFI,MAGA;AACJ3F,aAAO2F,MAAP;AACA;AA5C8C;;AAUhD,SAAK,IAAIjE,IAAI,CAAb,EAAgBA,IAAI+D,SAAStF,MAA7B,EAAqCuB,GAArC,EAA0C;AAAA,WAAjCA,CAAiC;AAmCzC;;AAED,WAAO1B,IAAP;AACA,IAhDD;AAiDA,GAtEY;;AAwEb;;;;AAIAsF,WAAS,EA5EI;;AA8EbS,mBAAiB;AAAA,UAAMxH,KAAKuG,MAAL,CAAYQ,OAAZ,CAAoBU,EAApB,KAA2BA,EAAjC;AAAA,GA9EJ;;AAgFb;;;;;;;;AAQAvH,aAAW;AACV,UAAO;AACN0G,YAAQ;AAAA,YAAK;AAAA,aAAK,CAACzE,CAAN;AAAA,MAAL;AAAA;AADF,IADG;AAIV,eAAY;AACXyE,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ;AAAA,YAAUlF,IAAIkF,CAAd;AAAA,KADG;AAEXL,cAAU,CAFC;AAGXF,YAAQ;AAHG,IAJF;AASV,aAAU;AACTF,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ;AAAA,YAAUlF,IAAIkF,CAAd;AAAA,KADC;AAETL,cAAU,CAFD;AAGTF,YAAQ;AAHC,IATA;AAcV,UAAO;AACNF,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ;AAAA,YAAU,CAAClF,CAAD,GAAK,CAACkF,CAAhB;AAAA,KADF;AAENP,YAAQ;AAFF,IAdG;AAkBV,eAAY;AACXF,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ,EAAU;AACjB,SAAIK,MAAMvF,CAAN,KAAYuF,MAAML,CAAN,CAAhB,EAA0B;AACzB,UAAIM,QAAQC,OAAOzF,CAAP,CAAZ;AAAA,UAAuB0F,QAAQD,OAAOP,CAAP,CAA/B;;AAEA,UAAIM,SAASE,KAAb,EAAoB;AACnB,cAAO,CAACF,QAAQE,KAAT,IAAgB,IAAvB;AACA;AACD;;AAED,YAAO1F,IAAIkF,CAAX;AACA,KAXU;AAYXP,YAAQ;AAZG,IAlBF;AAgCV,UAAO;AACNF,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ;AAAA,YAAUlF,IAAIkF,CAAd;AAAA;AADF,IAhCG;AAmCV,UAAO;AACNF,aAAS,IADH;AAENP,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ,EAAU;AAAA,iCACRrH,KAAKuG,MAAL,CAAYuB,oBAAZ,CAAiC3F,CAAjC,EAAoCkF,CAApC,CADQ;;AAAA;;AAChBlF,MADgB;AACbkF,MADa;;AAEjB,YAAOlF,KAAKkF,CAAZ;AACA,KALK;AAMNL,cAAU,IANJ;AAONF,YAAQ;AAPF,IAnCG;AA4CV,SAAM;AACLK,aAAS,IADJ;AAELP,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ,EAAU;AAAA,kCACRrH,KAAKuG,MAAL,CAAYuB,oBAAZ,CAAiC3F,CAAjC,EAAoCkF,CAApC,CADQ;;AAAA;;AAChBlF,MADgB;AACbkF,MADa;;AAEjB,YAAOlF,IAAIkF,CAAX;AACA,KALI;AAMLL,cAAU,IANL;AAOLF,YAAQ;AAPH,IA5CI;AAqDV,UAAO;AACNK,aAAS,IADH;AAENP,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ,EAAU;AAAA,kCACRrH,KAAKuG,MAAL,CAAYuB,oBAAZ,CAAiC3F,CAAjC,EAAoCkF,CAApC,CADQ;;AAAA;;AAChBlF,MADgB;AACbkF,MADa;;AAEjB,YAAOlF,KAAKkF,CAAZ;AACA,KALK;AAMNL,cAAU,IANJ;AAONF,YAAQ;AAPF,IArDG;AA8DV,SAAM;AACLK,aAAS,IADJ;AAELP,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ,EAAU;AAAA,kCACRrH,KAAKuG,MAAL,CAAYuB,oBAAZ,CAAiC3F,CAAjC,EAAoCkF,CAApC,CADQ;;AAAA;;AAChBlF,MADgB;AACbkF,MADa;;AAEjB,YAAOlF,IAAIkF,CAAX;AACA,KALI;AAMLL,cAAU,IANL;AAOLF,YAAQ;AAPH,IA9DI;AAuEV,SAAM;AACLK,aAAS,IADJ;AAELP,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ;AAAA,YAAUlF,KAAKkF,CAAf;AAAA,KAFH;AAGLP,YAAQ,CAAC,GAAD,EAAM,IAAN,CAHH;AAILE,cAAU;AAJL,IAvEI;AA6EV,UAAO;AACNG,aAAS,IADH;AAENP,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ;AAAA,YAAUlF,KAAKkF,CAAf;AAAA,KAFF;AAGNP,YAAQ,CAAC,IAAD,CAHF;AAINE,cAAU;AAJJ,IA7EG;AAmFV,UAAO;AACNG,aAAS,IADH;AAENP,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ;AAAA,YAAU,CAAC,CAAClF,CAAF,IAAO,CAAC,CAACkF,CAAnB;AAAA,KAFF;AAGNL,cAAU,IAHJ;AAINF,YAAQ;AAJF,IAnFG;AAyFV,SAAM;AACLK,aAAS,IADJ;AAELP,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ;AAAA,YAAU,CAAC,CAAClF,CAAF,IAAO,CAAC,CAACkF,CAAnB;AAAA,KAFH;AAGL7F,YAAQ,gBAACuG,CAAD,EAAIC,CAAJ;AAAA,YAAUD,KAAKC,CAAf;AAAA,KAHH;AAILhB,cAAU,KAJL;AAKLF,YAAQ;AALH,IAzFI;AAgGV,kBAAe;AACdA,YAAQ,GADM;AAEdE,cAAU,EAFI;AAGdJ,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ;AAAA,YAAU,MAAMlF,KAAK,EAAX,KAAkBkF,KAAK,EAAvB,CAAV;AAAA;AAHM,IAhGL;AAqGV,aAAU;AACTT,YAAQ,gBAACzE,CAAD,EAAIkF,CAAJ;AAAA,YAAUA,IAAGlF,CAAH,GAAO,IAAjB;AAAA;AADC;AArGA,GAxFE;;AAkMb2F,wBAAsB,8BAAS3F,CAAT,EAAYkF,CAAZ,EAAe;AACpC,OAAIK,MAAMvF,CAAN,KAAYuF,MAAML,CAAN,CAAhB,EAA0B;AACzB;AACA,QAAIY,KAAKL,OAAOzF,CAAP,CAAT;AAAA,QAAoB+F,KAAKN,OAAOP,CAAP,CAAzB;;AAEA,QAAIY,MAAMC,EAAV,EAAc;AACb;AACA,YAAO,CAACD,EAAD,EAAKC,EAAL,CAAP;AACA;AACD;;AAED,UAAO,CAAC/F,CAAD,EAAIkF,CAAJ,CAAP;AACA;AA9MY,EAAd;;AAiNA,MAAK,IAAIZ,IAAT,IAAiBzG,KAAKuG,MAAL,CAAYrG,SAA7B,EAAwC;AACvC,MAAIiI,UAAUnI,KAAKuG,MAAL,CAAYrG,SAAZ,CAAsBuG,IAAtB,CAAd;;AAEA,MAAI0B,QAAQvB,MAAR,CAAehF,MAAf,GAAwB,CAA5B,EAA+B;AAC9B5B,QAAKuG,MAAL,CAAYC,gBAAZ,CAA6BC,IAA7B,EAAmC0B,OAAnC;AACA,GAFD,MAGK;AACJnI,QAAKuG,MAAL,CAAYM,iBAAZ,CAA8BJ,IAA9B,EAAoC0B,OAApC;AACA;AACD;;AAED,KAAIC,UAAU;AACbzG,WAAS,KADI;AAEbgB,OAAK,QAFQ;AAGb0F,YAAU,OAHG;AAIbC,YAAU,cAJG;AAKbC,UAAQ,KALK;AAMbC,MAAI,kBANS;AAObC,MAAI,qCAPS;AAQbC,MAAI;AARS,EAAd;;AA3ZY,8BAsaHjC,KAtaG;AAuaX2B,UAAQ3B,KAAR,EAAckC,KAAd,CAAoB,MAApB,EAA4BC,OAA5B,CAAoC;AAAA,UAAS7I,EAAE8I,KAAF,IAAW9I,EAAE0G,KAAF,CAApB;AAAA,GAApC;AAvaW;;AAsaZ,MAAK,IAAIA,KAAT,IAAiB2B,OAAjB,EAA0B;AAAA,SAAjB3B,KAAiB;AAEzB;;AAED;AACAzG,MAAKC,SAAL,CAAe6I,KAAf,GAAuBC,KAAKC,KAAL,GAAY,IAAIA,KAAJ,CAAUjJ,CAAV,EAAa;AAC/Cc,OAAK,aAACoI,SAAD,EAAYlI,QAAZ,EAAyB;AAC7B,OAAIA,YAAYkI,SAAhB,EAA2B;AAC1B,WAAOA,UAAUlI,QAAV,CAAP;AACA;;AAED,OAAImI,YAAYnI,SAASkD,WAAT,IAAwBlD,SAASkD,WAAT,EAAxC;;AAEA,OAAIiF,aAAaD,UAAUE,cAAV,CAAyBD,SAAzB,CAAjB,EAAsD;AACrD,WAAOD,UAAUC,SAAV,CAAP;AACA;;AAED,OAAInI,YAAYe,IAAZ,IAAoBoH,aAAapH,IAArC,EAA2C;AAC1C,WAAOA,KAAKf,QAAL,KAAkBe,KAAKoH,SAAL,CAAzB;AACA;;AAED,OAAInI,YAAYgI,IAAhB,EAAsB;AACrB,WAAOA,KAAKhI,QAAL,CAAP;AACA;;AAED;AACA,UAAOA,QAAP;AACA,GAtB8C;;AAwB/C;AACA;AACA;AACAqI,OAAK,aAACH,SAAD,EAAYlI,QAAZ;AAAA,UAAyBA,YAAY,MAArC;AAAA;AA3B0C,EAAb,CAAZ,GA4BlBf,KAAKC,SA5BV;;AA8BA;;;AAGA,UAASqB,OAAT,CAAiBD,KAAjB,EAAwBgI,IAAxB,EAA8B;AAC7BhI,UAAQ0B,MAAMC,OAAN,CAAc3B,KAAd,IAAsBA,KAAtB,GAA+BgI,OAAMC,GAAGD,IAAH,CAAN,GAAiB,CAAChI,KAAD,CAAxD;;AAEA,SAAOA,MAAMa,MAAN,CAAa;AAAA,UAAU,CAACwF,MAAM6B,MAAN,CAAD,IAAkBA,WAAW,EAAvC;AAAA,GAAb,EAAwDtG,GAAxD,CAA4D;AAAA,UAAK,CAACqE,CAAN;AAAA,GAA5D,CAAP;AACA;;AAED,UAASM,MAAT,CAAgBjC,IAAhB,EAAsB;AACrB,MAAI,CAACA,IAAL,EAAW;AACV,UAAO,IAAP;AACA;;AAED,MAAI6D,EAAEC,IAAF,CAAO9D,IAAP,MAAiB,QAAjB,IAA6BA,KAAKzB,OAAL,CAAa,GAAb,MAAsB,CAAC,CAAxD,EAA2D;AAC1D;AACAyB,WAAQ,WAAR;AACA;;AAEDA,SAAO,IAAIV,IAAJ,CAASU,IAAT,CAAP;;AAEA,MAAI+B,MAAM/B,IAAN,CAAJ,EAAiB;AAChB,UAAO,IAAP;AACA;;AAED,SAAOA,IAAP;AACA;;AAED,UAASR,gBAAT,CAA0BuE,SAA1B,EAA4D;AAAA,MAAvBC,MAAuB,uEAAd,SAAc;AAAA,MAAHjD,CAAG;;AAC3D,MAAIkD,SAASC,SAASC,eAAT,CAAyBC,IAAzB,IAAiC,OAA9C;;AAEA,SAAO,UAASpE,IAAT,EAAgC;AAAA;;AAAA,OAAjBqE,MAAiB,uEAARL,MAAQ;;AACtChE,UAAOiC,OAAOjC,IAAP,CAAP;;AAEA,OAAI,CAACA,IAAL,EAAW;AACV,WAAO,EAAP;AACA;;AAED,OAAIsE,UAAUT,EAAEU,MAAF,6CACZR,SADY,EACAM,MADA,wCAEL,KAFK,eAGXtD,CAHW,CAAd;;AAKA,OAAIgD,aAAa,SAAb,IAA0BM,UAAU,SAAxC,EAAmD;AAClD5J,UAAMuF,KAAKwE,MAAL,MAAiB,CAAvB;AACA,IAFD,MAGK;AACJ,QAAI/J,MAAMuF,KAAKnD,cAAL,CAAoBoH,MAApB,EAA4BK,OAA5B,CAAV;AACA;;AAED,OAAID,UAAU,SAAV,IAAuB,CAACtC,MAAMtH,GAAN,CAA5B,EAAwC;AACvCA,UAAM,IAAIgK,MAAJ,CAAWhK,GAAX,CAAN;;AAEA,QAAIsJ,aAAa,OAAb,IAAwBA,aAAa,SAAzC,EAAoD;AACnDO,aAAQP,SAAR,IAAqB,MAArB;AACAtJ,SAAIqG,IAAJ,GAAWd,KAAKnD,cAAL,CAAoBoH,MAApB,EAA4BK,OAA5B,CAAX;;AAEAA,aAAQP,SAAR,IAAqB,OAArB;AACAtJ,SAAIiK,SAAJ,GAAgB1E,KAAKnD,cAAL,CAAoBoH,MAApB,EAA4BK,OAA5B,CAAhB;AACA;;AAED,QAAIP,aAAa,SAAjB,EAA4B;AAC3BO,aAAQP,SAAR,IAAqB,SAArB;AACAtJ,SAAIwF,QAAJ,GAAeD,KAAKnD,cAAL,CAAoBoH,MAApB,EAA4BK,OAA5B,CAAf;AACA;AACD;;AAED,UAAO7J,GAAP;AACA,GArCD;AAsCA;AAEA,CAhhBD","file":"../mavo.es5.js","sourcesContent":["/**\n * Functions available inside Mavo expressions\n */\n\n(function() {\n\nvar _ = Mavo.Functions = {\n\toperators: {\n\t\t\"=\": \"eq\"\n\t},\n\n\t// Read-only syntactic sugar for URL stuff\n\t$url: (function() {\n\t\tvar ret = {};\n\t\tvar url = new URL(location);\n\n\t\tfor (let pair of url.searchParams) {\n\t\t\tret[pair[0]] = pair[1];\n\t\t}\n\n\t\tObject.defineProperty(ret, \"toString\", {\n\t\t\tvalue: () => new URL(location)\n\t\t});\n\n\t\treturn ret;\n\t})(),\n\n\t/**\n\t * Get a property of an object. Used by the . operator to prevent TypeErrors\n\t */\n\tget: function(obj, property) {\n\t\treturn obj && obj[property] !== undefined? obj[property] : null;\n\t},\n\n\tunique: function(arr) {\n\t\treturn [...new Set(arr)];\n\t},\n\n\t/*********************\n\t * Number functions\n\t *********************/\n\n\t/**\n\t * Aggregate sum\n\t */\n\tsum: function(array) {\n\t\treturn numbers(array, arguments).reduce((prev, current) => {\n\t\t\treturn +prev + (+current || 0);\n\t\t}, 0);\n\t},\n\n\t/**\n\t * Average of an array of numbers\n\t */\n\taverage: function(array) {\n\t\tarray = numbers(array, arguments);\n\n\t\treturn array.length && _.sum(array) / array.length;\n\t},\n\n\t/**\n\t * Min of an array of numbers\n\t */\n\tmin: function(array) {\n\t\treturn Math.min(...numbers(array, arguments));\n\t},\n\n\t/**\n\t * Max of an array of numbers\n\t */\n\tmax: function(array) {\n\t\treturn Math.max(...numbers(array, arguments));\n\t},\n\n\tcount: function(array) {\n\t\treturn Mavo.toArray(array).filter(a => a !== null && a !== false && a !== \"\").length;\n\t},\n\n\tround: function(num, decimals) {\n\t\tif (!num || !decimals || !isFinite(num)) {\n\t\t\treturn Math.round(num);\n\t\t}\n\n\t\treturn +num.toLocaleString(\"en-US\", {\n\t\t\tuseGrouping: false,\n\t\t\tmaximumFractionDigits: decimals\n\t\t});\n\t},\n\n\tiff: function(condition, iftrue, iffalse=\"\") {\n\t\tif (Array.isArray(condition)) {\n\t\t\treturn condition.map((c, i) => {\n\t\t\t\tvar ret = c? iftrue : iffalse;\n\n\t\t\t\tif (Array.isArray(ret)) {\n\t\t\t\t\treturn ret[Math.min(i, ret.length - 1)];\n\t\t\t\t}\n\n\t\t\t\treturn ret;\n\t\t\t});\n\t\t}\n\n\t\treturn condition? iftrue : iffalse;\n\t},\n\n\t/*********************\n\t * String functions\n\t *********************/\n\n\t/**\n\t * Replace all occurences of a string with another string\n\t */\n\treplace: function(haystack, needle, replacement = \"\", iterations = 1) {\n\t\tif (Array.isArray(haystack)) {\n\t\t\treturn haystack.map(item => _.replace(item, needle, replacement));\n\t\t}\n\n\t\t// Simple string replacement\n\t\tvar needleRegex = RegExp(Mavo.escapeRegExp(needle), \"g\");\n\t\tvar ret = haystack, prev;\n\t\tvar counter = 0;\n\n\t\twhile (ret != prev && (counter++ < iterations)) {\n\t\t\tprev = ret;\n\t\t\tret = ret.replace(needleRegex, replacement);\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\tlen: str => (str || \"\").length,\n\t/**\n\t * Case insensitive search\n\t */\n\tsearch: (haystack, needle) => haystack && needle? haystack.toLowerCase().indexOf(needle.toLowerCase()) : -1,\n\n\tstarts: (haystack, needle) => _.search(haystack, needle) === 0,\n\tends: function(haystack, needle) {\n\t\tvar i = _.search(haystack, needle);\n\t\treturn  i > -1 && i === haystack.length - needle.length;\n\t},\n\n\tjoin: function(array, glue = \"\") {\n\t\treturn Mavo.toArray(array).join(glue);\n\t},\n\n\tidify: readable => ((readable || \"\") + \"\")\n\t\t.replace(/\\s+/g, \"-\") // Convert whitespace to hyphens\n\t\t.replace(/[^\\w-]/g, \"\") // Remove weird characters\n\t\t.toLowerCase(),\n\n\t// Convert an identifier to readable text that can be used as a label\n\treadable: function (identifier) {\n\t\t// Is it camelCase?\n\t\treturn identifier && identifier\n\t\t\t\t .replace(/([a-z])([A-Z])(?=[a-z])/g, ($0, $1, $2) => $1 + \" \" + $2.toLowerCase()) // camelCase?\n\t\t\t\t .replace(/([a-z])[_\\/-](?=[a-z])/g, \"$1 \") // Hyphen-separated / Underscore_separated?\n\t\t\t\t .replace(/^[a-z]/, $0 => $0.toUpperCase()); // Capitalize\n\t},\n\n\tuppercase: str => (str + \"\").toUpperCase(),\n\tlowercase: str => (str + \"\").toLowerCase(),\n\n\t/*********************\n\t * Date functions\n\t *********************/\n\n\tget $now() {\n\t\treturn new Date();\n\t},\n\n\tyear: getDateComponent(\"year\"),\n\tmonth: getDateComponent(\"month\"),\n\tday: getDateComponent(\"day\"),\n\tweekday: getDateComponent(\"weekday\"),\n\thour: getDateComponent(\"hour\"),\n\thour12: getDateComponent(\"hour\", \"numeric\", {hour12:true}),\n\tminute: getDateComponent(\"minute\"),\n\tsecond: getDateComponent(\"second\"),\n\n\tdate: date => {\n\t\treturn `${_.year(date)}-${_.month(date).twodigit}-${_.day(date).twodigit}`;\n\t},\n\ttime: date => {\n\t\treturn `${_.hour(date).twodigit}:${_.minute(date).twodigit}:${_.second(date).twodigit}`;\n\t},\n\n\tminutes: seconds => Math.floor(Math.abs(seconds) / 60),\n\thours: seconds => Math.floor(Math.abs(seconds) / 3600),\n\tdays: seconds => Math.floor(Math.abs(seconds) / 86400),\n\tweeks: seconds => Math.floor(Math.abs(seconds) / 604800),\n\tmonths: seconds => Math.floor(Math.abs(seconds) / (30.4368 * 86400)),\n\tyears: seconds => Math.floor(Math.abs(seconds) / (30.4368 * 86400 * 12)),\n};\n\nMavo.Script = {\n\taddUnaryOperator: function(name, o) {\n\t\treturn operand => Array.isArray(operand)? operand.map(o.scalar) : o.scalar(operand);\n\t},\n\n\t/**\n\t * Extend a scalar operator to arrays, or arrays and scalars\n\t * The operation between arrays is applied element-wise.\n\t * The operation operation between a scalar and an array will result in\n\t * the operation being applied between the scalar and every array element.\n\t */\n\taddBinaryOperator: function(name, o) {\n\t\tif (o.symbol) {\n\t\t\t// Build map of symbols to function names for easy rewriting\n\t\t\tfor (let symbol of Mavo.toArray(o.symbol)) {\n\t\t\t\tMavo.Script.symbols[symbol] = name;\n\t\t\t}\n\t\t}\n\n\t\to.identity = o.identity === undefined? 0 : o.identity;\n\n\t\treturn _[name] = o.code || function(...operands) {\n\t\t\tif (operands.length === 1) {\n\t\t\t\tif (Array.isArray(operands[0])) {\n\t\t\t\t\t// Operand is an array of operands, expand it out\n\t\t\t\t\toperands = [...operands[0]];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar prev = o.logical? o.identity : operands[0], result;\n\n\t\t\tfor (let i = 1; i < operands.length; i++) {\n\t\t\t\tlet a = o.logical? operands[i - 1] : prev;\n\t\t\t\tlet b = operands[i];\n\n\t\t\t\tif (Array.isArray(b)) {\n\t\t\t\t\tif (typeof o.identity == \"number\") {\n\t\t\t\t\t\tb = numbers(b);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Array.isArray(a)) {\n\t\t\t\t\t\tresult = [\n\t\t\t\t\t\t\t...b.map((n, i) => o.scalar(a[i] === undefined? o.identity : a[i], n)),\n\t\t\t\t\t\t\t...a.slice(b.length)\n\t\t\t\t\t\t];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tresult = b.map(n => o.scalar(a, n));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (Array.isArray(a)) {\n\t\t\t\t\tresult = a.map(n => o.scalar(n, b));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tresult = o.scalar(a, b);\n\t\t\t\t}\n\n\t\t\t\tif (o.reduce) {\n\t\t\t\t\tprev = o.reduce(prev, result, a, b);\n\t\t\t\t}\n\t\t\t\telse if (o.logical) {\n\t\t\t\t\tprev = prev && result;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tprev = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn prev;\n\t\t};\n\t},\n\n\t/**\n\t * Mapping of operator symbols to function name.\n\t * Populated via addOperator() and addLogicalOperator()\n\t */\n\tsymbols: {},\n\n\tgetOperatorName: op => Mavo.Script.symbols[op] || op,\n\n\t/**\n\t * Operations for elements and scalars.\n\t * Operations between arrays happen element-wise.\n\t * Operations between a scalar and an array will result in the operation being performed between the scalar and every array element.\n\t * Ordered by precedence (higher to lower)\n\t * @param scalar {Function} The operation between two scalars\n\t * @param identity The operation’s identity element. Defaults to 0.\n\t */\n\toperators: {\n\t\t\"not\": {\n\t\t\tscalar: a => a => !a\n\t\t},\n\t\t\"multiply\": {\n\t\t\tscalar: (a, b) => a * b,\n\t\t\tidentity: 1,\n\t\t\tsymbol: \"*\"\n\t\t},\n\t\t\"divide\": {\n\t\t\tscalar: (a, b) => a / b,\n\t\t\tidentity: 1,\n\t\t\tsymbol: \"/\"\n\t\t},\n\t\t\"add\": {\n\t\t\tscalar: (a, b) => +a + +b,\n\t\t\tsymbol: \"+\"\n\t\t},\n\t\t\"subtract\": {\n\t\t\tscalar: (a, b) => {\n\t\t\t\tif (isNaN(a) || isNaN(b)) {\n\t\t\t\t\tvar dateA = toDate(a), dateB = toDate(b);\n\n\t\t\t\t\tif (dateA && dateB) {\n\t\t\t\t\t\treturn (dateA - dateB)/1000;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn a - b;\n\t\t\t},\n\t\t\tsymbol: \"-\"\n\t\t},\n\t\t\"mod\": {\n\t\t\tscalar: (a, b) => a % b\n\t\t},\n\t\t\"lte\": {\n\t\t\tlogical: true,\n\t\t\tscalar: (a, b) => {\n\t\t\t\t[a, b] = Mavo.Script.getNumericalOperands(a, b);\n\t\t\t\treturn a <= b;\n\t\t\t},\n\t\t\tidentity: true,\n\t\t\tsymbol: \"<=\"\n\t\t},\n\t\t\"lt\": {\n\t\t\tlogical: true,\n\t\t\tscalar: (a, b) => {\n\t\t\t\t[a, b] = Mavo.Script.getNumericalOperands(a, b);\n\t\t\t\treturn a < b;\n\t\t\t},\n\t\t\tidentity: true,\n\t\t\tsymbol: \"<\"\n\t\t},\n\t\t\"gte\": {\n\t\t\tlogical: true,\n\t\t\tscalar: (a, b) => {\n\t\t\t\t[a, b] = Mavo.Script.getNumericalOperands(a, b);\n\t\t\t\treturn a >= b;\n\t\t\t},\n\t\t\tidentity: true,\n\t\t\tsymbol: \">=\"\n\t\t},\n\t\t\"gt\": {\n\t\t\tlogical: true,\n\t\t\tscalar: (a, b) => {\n\t\t\t\t[a, b] = Mavo.Script.getNumericalOperands(a, b);\n\t\t\t\treturn a > b;\n\t\t\t},\n\t\t\tidentity: true,\n\t\t\tsymbol: \">\"\n\t\t},\n\t\t\"eq\": {\n\t\t\tlogical: true,\n\t\t\tscalar: (a, b) => a == b,\n\t\t\tsymbol: [\"=\", \"==\"],\n\t\t\tidentity: true\n\t\t},\n\t\t\"neq\": {\n\t\t\tlogical: true,\n\t\t\tscalar: (a, b) => a != b,\n\t\t\tsymbol: [\"!=\"],\n\t\t\tidentity: true\n\t\t},\n\t\t\"and\": {\n\t\t\tlogical: true,\n\t\t\tscalar: (a, b) => !!a && !!b,\n\t\t\tidentity: true,\n\t\t\tsymbol: \"&&\"\n\t\t},\n\t\t\"or\": {\n\t\t\tlogical: true,\n\t\t\tscalar: (a, b) => !!a || !!b,\n\t\t\treduce: (p, r) => p || r,\n\t\t\tidentity: false,\n\t\t\tsymbol: \"||\"\n\t\t},\n\t\t\"concatenate\": {\n\t\t\tsymbol: \"&\",\n\t\t\tidentity: \"\",\n\t\t\tscalar: (a, b) => \"\" + (a || \"\") + (b || \"\")\n\t\t},\n\t\t\"filter\": {\n\t\t\tscalar: (a, b) => b? a : null\n\t\t}\n\t},\n\n\tgetNumericalOperands: function(a, b) {\n\t\tif (isNaN(a) || isNaN(b)) {\n\t\t\t// Try comparing as dates\n\t\t\tvar da = toDate(a), db = toDate(b);\n\n\t\t\tif (da && db) {\n\t\t\t\t// Both valid dates\n\t\t\t\treturn [da, db];\n\t\t\t}\n\t\t}\n\n\t\treturn [a, b];\n\t}\n};\n\nfor (let name in Mavo.Script.operators) {\n\tlet details = Mavo.Script.operators[name];\n\n\tif (details.scalar.length < 2) {\n\t\tMavo.Script.addUnaryOperator(name, details);\n\t}\n\telse {\n\t\tMavo.Script.addBinaryOperator(name, details);\n\t}\n}\n\nvar aliases = {\n\taverage: \"avg\",\n\tiff: \"iff IF\",\n\tsubtract: \"minus\",\n\tmultiply: \"mult product\",\n\tdivide: \"div\",\n\tlt: \"lessThan smaller\",\n\tgt: \"moreThan greater greaterThan bigger\",\n\teq: \"equal equality\"\n};\n\nfor (let name in aliases) {\n\taliases[name].split(/\\s+/g).forEach(alias => _[alias] = _[name]);\n}\n\n// Make function names case insensitive\nMavo.Functions._Trap = self.Proxy? new Proxy(_, {\n\tget: (functions, property) => {\n\t\tif (property in functions) {\n\t\t\treturn functions[property];\n\t\t}\n\n\t\tvar propertyL = property.toLowerCase && property.toLowerCase();\n\n\t\tif (propertyL && functions.hasOwnProperty(propertyL)) {\n\t\t\treturn functions[propertyL];\n\t\t}\n\n\t\tif (property in Math || propertyL in Math) {\n\t\t\treturn Math[property] || Math[propertyL];\n\t\t}\n\n\t\tif (property in self) {\n\t\t\treturn self[property];\n\t\t}\n\n\t\t// Prevent undefined at all costs\n\t\treturn property;\n\t},\n\n\t// Super ugly hack, but otherwise data is not\n\t// the local variable it should be, but the string \"data\"\n\t// so all property lookups fail.\n\thas: (functions, property) => property != \"data\"\n}) : Mavo.Functions;\n\n/**\n * Private helper methods\n */\nfunction numbers(array, args) {\n\tarray = Array.isArray(array)? array : (args? $$(args) : [array]);\n\n\treturn array.filter(number => !isNaN(number) && number !== \"\").map(n => +n);\n}\n\nfunction toDate(date) {\n\tif (!date) {\n\t\treturn null;\n\t}\n\n\tif ($.type(date) === \"string\" && date.indexOf(\":\") === -1) {\n\t\t// Dates without a time are parsed as UTC, we want local timezone\n\t\tdate += \" 00:00:00\";\n\t}\n\n\tdate = new Date(date);\n\n\tif (isNaN(date)) {\n\t\treturn null;\n\t}\n\n\treturn date;\n}\n\nfunction getDateComponent(component, option = \"numeric\", o) {\n\tvar locale = document.documentElement.lang || \"en-GB\";\n\n\treturn function(date, format = option) {\n\t\tdate = toDate(date);\n\n\t\tif (!date) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\tvar options = $.extend({\n\t\t\t[component]: format,\n\t\t\thour12: false\n\t\t}, o);\n\n\t\tif (component == \"weekday\" && format == \"numeric\") {\n\t\t\tret = date.getDay() || 7;\n\t\t}\n\t\telse {\n\t\t\tvar ret = date.toLocaleString(locale, options);\n\t\t}\n\n\t\tif (format == \"numeric\" && !isNaN(ret)) {\n\t\t\tret = new Number(ret);\n\n\t\t\tif (component == \"month\" || component == \"weekday\") {\n\t\t\t\toptions[component] = \"long\";\n\t\t\t\tret.name = date.toLocaleString(locale, options);\n\n\t\t\t\toptions[component] = \"short\";\n\t\t\t\tret.shortname = date.toLocaleString(locale, options);\n\t\t\t}\n\n\t\t\tif (component != \"weekday\") {\n\t\t\t\toptions[component] = \"2-digit\";\n\t\t\t\tret.twodigit = date.toLocaleString(locale, options);\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t};\n}\n\n})();\n"]}