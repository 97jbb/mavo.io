{"version":3,"sources":["elements.js"],"names":["$","$$","_","Mavo","Elements","Object","defineProperties","value","selector","o","arguments","s","register","all","toArray","config","attribute","extend","push","element","datatype","matches","length","selectorloop","id","attributeMatches","undefined","default","test","isSVG","e","namespaceURI","defaultEditors","tag","type","a","editor","modes","changeEvents","getValue","setValue","form","name","checked","toCheck","properties","init","mavo","addEventListener","evt","target","setAttribute","clicked","getAttribute","edit","min","max","range","step","left","getBoundingClientRect","offset","Math","clientX","offsetWidth","newValue","mod","sneak","keyCode","increment","shiftKey","done","unbind","display","getComputedStyle","indexOf","create","width","setEditorValue","cs","whiteSpace","replace","types","datetime","humanReadable","date","Date","isNaN","label","options","day","month","year","hour","minute","format","timeZone","toLocaleString","popup","Bliss"],"mappings":"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","file":"../mavo.es5.js","sourcesContent":["/**\n * Configuration for different types of elements. Options:\n * - attribute {String}\n * - useProperty {Boolean}\n * - datatype {\"number\"|\"boolean\"|\"string\"} Default is \"string\"\n * - modes\n * - editor {Object|Function}\n * - setEditorValue temporary\n * - edit\n * - done\n * - observe\n * - default: If there is no attribute, can we use that rule to pick one?\n * @\n */\n(function($, $$) {\n\nvar _ = Mavo.Elements = {};\n\nObject.defineProperties(_, {\n\t\"register\": {\n\t\tvalue: function(selector, o) {\n\t\t\tif (typeof arguments[0] === \"object\") {\n\t\t\t\t// Multiple definitions\n\t\t\t\tfor (let s in arguments[0]) {\n\t\t\t\t\t_.register(s, arguments[0][s]);\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar all = Mavo.toArray(arguments[1]);\n\n\t\t\tfor (config of all) {\n\t\t\t\tconfig.attribute = Mavo.toArray(config.attribute || null);\n\n\t\t\t\tfor (attribute of config.attribute) {\n\t\t\t\t\tlet o = $.extend({}, config);\n\t\t\t\t\to.attribute = attribute;\n\t\t\t\t\t_[selector] = _[selector] || [];\n\t\t\t\t\t_[selector].push(o);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn _;\n\t\t}\n\t},\n\t\"search\": {\n\t\tvalue: function(element, attribute, datatype) {\n\t\t\tvar matches = _.matches(element, attribute, datatype);\n\n\t\t\treturn matches[matches.length - 1] || { attribute };\n\t\t}\n\t},\n\t\"matches\": {\n\t\tvalue: function(element, attribute, datatype) {\n\t\t\tvar matches = [];\n\n\t\t\tselectorloop: for (var id in _) {\n\t\t\t\tfor (var o of _[id]) {\n\t\t\t\t\t// Passes attribute test?\n\t\t\t\t\tvar attributeMatches = attribute === undefined && o.default || attribute === o.attribute;\n\n\t\t\t\t\tif (!attributeMatches) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Passes datatype test?\n\t\t\t\t\tif (datatype !== undefined && datatype !== \"string\" && datatype !== o.datatype) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Passes selector test?\n\t\t\t\t\tvar selector = o.selector || id;\n\t\t\t\t\tif (!element.matches(selector)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Passes arbitrary test?\n\t\t\t\t\tif (o.test && !o.test(element, attribute, datatype)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t// All tests have passed\n\t\t\t\t\tmatches.push(o);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn matches;\n\t\t}\n\t},\n\n\tisSVG: {\n\t\tvalue: e => e.namespaceURI == \"http://www.w3.org/2000/svg\"\n\t},\n\n\tdefaultEditors: {\n\t\tvalue: {\n\t\t\t\"string\":  { tag: \"input\" },\n\t\t\t\"number\":  { tag: \"input\", type: \"number\" },\n\t\t\t\"boolean\": { tag: \"input\", type: \"checkbox\" }\n\t\t}\n\t}\n});\n\n_.register({\n\t\"*\": [\n\t\t{\n\t\t\ttest: (e, a) => a == \"hidden\",\n\t\t\tattribute: \"hidden\",\n\t\t\tdatatype: \"boolean\"\n\t\t},\n\t\t{\n\t\t\ttest: _.isSVG,\n\t\t\tattribute: \"y\",\n\t\t\tdatatype: \"number\"\n\t\t},\n\t\t{\n\t\t\tdefault: true,\n\t\t\ttest: _.isSVG,\n\t\t\tattribute: \"x\",\n\t\t\tdatatype: \"number\"\n\t\t},\n\t],\n\n\t\"media\": {\n\t\tdefault: true,\n\t\tselector: \"img, video, audio\",\n\t\tattribute: \"src\",\n\t\teditor: {\n\t\t\t\"tag\": \"input\",\n\t\t\t\"type\": \"url\",\n\t\t\t\"placeholder\": \"http://example.com\"\n\t\t}\n\t},\n\n\t\"video, audio\": {\n\t\tattribute: [\"autoplay\", \"buffered\", \"loop\"],\n\t\tdatatype: \"boolean\"\n\t},\n\n\t\"a, link\": {\n\t\tdefault: true,\n\t\tattribute: \"href\"\n\t},\n\n\t\"input, select, button, textarea\": {\n\t\tattribute: \"disabled\",\n\t\tdatatype: \"boolean\"\n\t},\n\n\t\"select, input\": {\n\t\tdefault: true,\n\t\tattribute: \"value\",\n\t\tmodes: \"read\",\n\t\tchangeEvents: \"input change\"\n\t},\n\n\t\"textarea\": {\n\t\tdefault: true,\n\t\tmodes: \"read\",\n\t\tchangeEvents: \"input\",\n\t\tgetValue: element => element.value,\n\t\tsetValue: (element, value) => element.value = value\n\t},\n\n\t\"input[type=range], input[type=number]\": {\n\t\tdefault: true,\n\t\tattribute: \"value\",\n\t\tdatatype: \"number\",\n\t\tmodes: \"read\",\n\t\tchangeEvents: \"input change\"\n\t},\n\n\t\"input[type=checkbox]\": {\n\t\tdefault: true,\n\t\tattribute: \"checked\",\n\t\tdatatype: \"boolean\",\n\t\tmodes: \"read\",\n\t\tchangeEvents: \"click\"\n\t},\n\n\t\"input[type=radio]\": {\n\t\tdefault: true,\n\t\tattribute: \"checked\",\n\t\tmodes: \"read\",\n\t\tgetValue: element => {\n\t\t\tif (element.form) {\n\t\t\t\treturn element.form[element.name].value;\n\t\t\t}\n\n\t\t\tvar checked = $(`input[type=radio][name=\"${element.name}\"]:checked`);\n\t\t\treturn checked && checked.value;\n\t\t},\n\t\tsetValue: (element, value) => {\n\t\t\tif (element.form) {\n\t\t\t\telement.form[element.name].value = value;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar toCheck = $(`input[type=radio][name=\"${element.name}\"][value=\"${value}\"]`);\n\t\t\t$.properties(toCheck, {checked: true});\n\t\t},\n\t\tinit: function(element) {\n\t\t\tthis.mavo.element.addEventListener(\"change\", evt => {\n\t\t\t\tif (evt.target.name == element.name) {\n\t\t\t\t\tthis.value = this.getValue();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t\"button, .counter\": {\n\t\tdefault: true,\n\t\tattribute: \"mv-clicked\",\n\t\tdatatype: \"number\",\n\t\tmodes: \"read\",\n\t\tinit: function(element) {\n\t\t\tif (this.attribute === \"mv-clicked\") {\n\t\t\t\telement.setAttribute(\"mv-clicked\", \"0\");\n\n\t\t\t\telement.addEventListener(\"click\", evt => {\n\t\t\t\t\tlet clicked = +element.getAttribute(\"mv-clicked\") || 0;\n\t\t\t\t\tthis.value = ++clicked;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\n\t\"meter, progress\": {\n\t\tdefault: true,\n\t\tattribute: \"value\",\n\t\tdatatype: \"number\",\n\t\tedit: function() {\n\t\t\tvar min = +this.element.getAttribute(\"min\") || 0;\n\t\t\tvar max = +this.element.getAttribute(\"max\") || 1;\n\t\t\tvar range = max - min;\n\t\t\tvar step = +this.element.getAttribute(\"mv-edit-step\") || (range > 1? 1 : range/100);\n\n\t\t\tthis.element.addEventListener(\"mousemove.mavo:edit\", evt => {\n\t\t\t\t// Change property as mouse moves\n\t\t\t\tvar left = this.element.getBoundingClientRect().left;\n\t\t\t\tvar offset = Math.max(0, (evt.clientX - left) / this.element.offsetWidth);\n\t\t\t\tvar newValue = min + range * offset;\n\t\t\t\tvar mod = newValue % step;\n\n\t\t\t\tnewValue += mod > step/2? step - mod : -mod;\n\t\t\t\tnewValue = Math.max(min, Math.min(newValue, max));\n\n\t\t\t\tthis.sneak(() => this.element.setAttribute(\"value\", newValue));\n\t\t\t});\n\n\t\t\tthis.element.addEventListener(\"mouseleave.mavo:edit\", evt => {\n\t\t\t\t// Return to actual value\n\t\t\t\tthis.sneak(() => this.element.setAttribute(\"value\", this.value));\n\t\t\t});\n\n\t\t\tthis.element.addEventListener(\"click.mavo:edit\", evt => {\n\t\t\t\t// Register change\n\t\t\t\tthis.value = this.getValue();\n\t\t\t});\n\n\t\t\tthis.element.addEventListener(\"keydown.mavo:edit\", evt => {\n\t\t\t\t// Edit with arrow keys\n\t\t\t\tif (evt.target == this.element && (evt.keyCode == 37 || evt.keyCode == 39)) {\n\t\t\t\t\tvar increment = step * (evt.keyCode == 39? 1 : -1) * (evt.shiftKey? 10 : 1);\n\t\t\t\t\tvar newValue = this.value + increment;\n\t\t\t\t\tnewValue = Math.max(min, Math.min(newValue, max));\n\n\t\t\t\t\tthis.element.setAttribute(\"value\", newValue);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tdone: function() {\n\t\t\t$.unbind(this.element, \".mavo:edit\");\n\t\t}\n\t},\n\n\t\"meta\": {\n\t\tdefault: true,\n\t\tattribute: \"content\"\n\t},\n\n\t\"block\": {\n\t\tdefault: true,\n\t\tselector: \"p, div, li, dt, dd, h1, h2, h3, h4, h5, h6, article, section, address\",\n\t\teditor: function() {\n\t\t\tvar display = getComputedStyle(this.element).display;\n\t\t\tvar tag = display.indexOf(\"inline\") === 0? \"input\" : \"textarea\";\n\t\t\tvar editor = $.create(tag);\n\n\t\t\tif (tag == \"textarea\") {\n\t\t\t\t// Actually multiline\n\t\t\t\tvar width = this.element.offsetWidth;\n\n\t\t\t\tif (width) {\n\t\t\t\t\teditor.width = width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn editor;\n\t\t},\n\n\t\tsetEditorValue: function(value) {\n\t\t\tif (this.datatype && this.datatype != \"string\") {\n\t\t\t\tvalue = value + \"\";\n\t\t\t}\n\n\t\t\tvar cs = getComputedStyle(this.element);\n\t\t\tvalue = value || \"\";\n\n\t\t\tif ([\"normal\", \"nowrap\"].indexOf(cs.whiteSpace) > -1) {\n\t\t\t\t// Collapse lines\n\t\t\t\tvalue = value.replace(/\\r?\\n/g, \" \");\n\t\t\t}\n\n\t\t\tif ([\"normal\", \"nowrap\", \"pre-line\"].indexOf(cs.whiteSpace) > -1) {\n\t\t\t\t// Collapse whitespace\n\t\t\t\tvalue = value.replace(/^[ \\t]+|[ \\t]+$/gm, \"\").replace(/[ \\t]+/g, \" \");\n\t\t\t}\n\n\t\t\tthis.editor.value = value;\n\t\t\treturn true;\n\t\t}\n\t},\n\n\t\"time\": {\n\t\tattribute: \"datetime\",\n\t\tdefault: true,\n\t\teditor: function() {\n\t\t\tvar types = {\n\t\t\t\t\"date\": /^[Y\\d]{4}-[M\\d]{2}-[D\\d]{2}$/i,\n\t\t\t\t\"month\": /^[Y\\d]{4}-[M\\d]{2}$/i,\n\t\t\t\t\"time\": /^[H\\d]{2}:[M\\d]{2}/i,\n\t\t\t\t\"week\": /[Y\\d]{4}-W[W\\d]{2}$/i,\n\t\t\t\t\"datetime-local\": /^[Y\\d]{4}-[M\\d]{2}-[D\\d]{2} [H\\d]{2}:[M\\d]{2}/i\n\t\t\t};\n\n\t\t\tvar datetime = this.element.getAttribute(\"datetime\") || \"YYYY-MM-DD\";\n\n\t\t\tfor (var type in types) {\n\t\t\t\tif (types[type].test(datetime)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {tag: \"input\", type};\n\t\t},\n\t\thumanReadable: function (value) {\n\t\t\tvar date = new Date(value);\n\n\t\t\tif (!value || isNaN(date)) {\n\t\t\t\treturn \"(No \" + this.label + \")\";\n\t\t\t}\n\n\t\t\t// TODO do this properly (account for other datetime datatypes and different formats)\n\t\t\tvar options = {\n\t\t\t\t\"date\": {day: \"numeric\", month: \"short\", year: \"numeric\"},\n\t\t\t\t\"month\": {month: \"long\"},\n\t\t\t\t\"time\": {hour: \"numeric\", minute: \"numeric\"},\n\t\t\t\t\"datetime-local\": {day: \"numeric\", month: \"short\", year: \"numeric\", hour: \"numeric\", minute: \"numeric\"}\n\t\t\t};\n\n\t\t\tvar format = options[this.editor && this.editor.type] || options.date;\n\t\t\tformat.timeZone = \"UTC\";\n\n\t\t\treturn date.toLocaleString(\"en-GB\", format);\n\t\t}\n\t},\n\n\t\"circle\": [\n\t\t{\n\t\t\tdefault: true,\n\t\t\tattribute: \"r\",\n\t\t\tdatatype: \"number\"\n\t\t}, {\n\t\t\tattribute: [\"cx\", \"cy\"],\n\t\t\tdatatype: \"number\"\n\t\t}\n\t],\n\n\t\"text\": {\n\t\tdefault: true,\n\t\tpopup: true\n\t}\n});\n\n})(Bliss, Bliss.$);\n"]}