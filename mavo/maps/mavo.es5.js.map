{"version":3,"sources":["ui.message.js"],"names":["$","$$","_","Mavo","UI","Message","Class","constructor","mavo","message","o","closed","defer","element","create","className","type","innerHTML","events","click","scrollIntoViewIfNeeded","after","bar","classes","classList","add","setAttribute","dismiss","Array","isArray","toArray","prop","button","textContent","close","start","timeout","closeTimeout","mouseenter","clearTimeout","mouseleave","rr","setTimeout","submit","addEventListener","evt","preventDefault","target","resolve","transition","opacity","then","remove","Bliss"],"mappings":"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","file":"../mavo.es5.js","sourcesContent":["(function ($, $$) {\n\nvar _ = Mavo.UI.Message = $.Class({\n\tconstructor: function(mavo, message, o) {\n\t\tthis.mavo = mavo;\n\t\tthis.message = message;\n\t\tthis.closed = Mavo.defer();\n\n\t\tthis.element = $.create({\n\t\t\tclassName: \"mv-ui mv-message\" + (o.type? \" mv-\" + o.type : \"\"),\n\t\t\tinnerHTML: this.message,\n\t\t\tevents: {\n\t\t\t\tclick: e => Mavo.scrollIntoViewIfNeeded(this.mavo.element)\n\t\t\t},\n\t\t\tafter: this.mavo.bar.element\n\t\t});\n\n\t\tif (o.classes) {\n\t\t\tthis.element.classList.add(o.classes);\n\t\t}\n\n\t\tif (o.type == \"error\") {\n\t\t\tthis.element.setAttribute(\"role\", \"alert\");\n\t\t}\n\t\telse {\n\t\t\tthis.element.setAttribute(\"aria-live\", \"polite\");\n\t\t}\n\n\t\to.dismiss = o.dismiss || {};\n\n\t\tif (typeof o.dismiss == \"string\" || Array.isArray(o.dismiss)) {\n\t\t\tvar dismiss = {};\n\t\t\tfor (let prop of Mavo.toArray(o.dismiss)) {\n\t\t\t\tdismiss[prop] = true;\n\t\t\t}\n\t\t\to.dismiss = dismiss;\n\t\t}\n\n\t\tif (o.dismiss.button) {\n\t\t\t$.create(\"button\", {\n\t\t\t\tclassName: \"mv-close mv-ui\",\n\t\t\t\ttextContent: \"Ã—\",\n\t\t\t\tevents: {\n\t\t\t\t\t\"click\": evt => this.close()\n\t\t\t\t},\n\t\t\t\tstart: this.element\n\t\t\t});\n\t\t}\n\n\t\tif (o.dismiss.timeout) {\n\t\t\tvar timeout = typeof o.dismiss.timeout === \"number\"? o.dismiss.timeout : 5000;\n\t\t\tvar closeTimeout;\n\n\t\t\t$.events(this.element, {\n\t\t\t\tmouseenter: e => clearTimeout(closeTimeout),\n\t\t\t\tmouseleave: Mavo.rr(e => closeTimeout = setTimeout(() => this.close(), timeout)),\n\t\t\t});\n\t\t}\n\n\t\tif (o.dismiss.submit) {\n\t\t\tthis.element.addEventListener(\"submit\", evt => {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tthis.close(evt.target);\n\t\t\t});\n\t\t}\n\t},\n\n\tclose: function(resolve) {\n\t\t$.transition(this.element, {opacity: 0}).then(() => {\n\t\t\t$.remove(this.element);\n\t\t\tthis.closed.resolve(resolve);\n\t\t});\n\t}\n});\n\n})(Bliss, Bliss.$);\n"]}