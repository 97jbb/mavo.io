{"version":3,"sources":["elements.js"],"names":["$","$$","_","Mavo","Elements","Object","defineProperties","value","id","config","arguments","s","register","extend","base","p","indexOf","parts","split","selector","attribute","undefined","Array","isArray","o","element","datatype","matches","length","selectorloop","attributeMatches","default","test","push","isSVG","e","namespaceURI","defaultEditors","tag","type","editor","uploadBackend","mavo","storage","upload","mainInput","create","self","FileReader","popup","nodeName","toLowerCase","path","getAttribute","file","name","then","url","fire","uploadEvents","item","evt","clipboardData","items","kind","Date","now","slice","getAsFile","preventDefault","stopPropagation","classList","add","remove","dataTransfer","files","events","className","contents","accept","change","target","innerHTML","modes","changeEvents","edit","done","init","getValue","setValue","form","checked","toCheck","properties","addEventListener","setAttribute","clicked","min","max","range","step","left","getBoundingClientRect","offset","Math","clientX","offsetWidth","newValue","mod","sneak","keyCode","increment","shiftKey","unbind","display","getComputedStyle","width","setEditorValue","cs","whiteSpace","replace","label","fromTemplate","dateFormat","DOMExpression","search","datetime","dateTypes","dateType","textContent","defaultFormats","property","expressions","extract","Bliss"],"mappings":"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","file":"../mavo.es5.js","sourcesContent":["/**\n * Configuration for different types of elements. Options:\n * - attribute {String}\n * - useProperty {Boolean}\n * - datatype {\"number\"|\"boolean\"|\"string\"} Default is \"string\"\n * - modes\n * - editor {Object|Function}\n * - setEditorValue temporary\n * - edit\n * - done\n * - observe\n * - default: If there is no attribute, can we use that rule to pick one?\n * @\n */\n(function($, $$) {\n\nvar _ = Mavo.Elements = {};\n\nObject.defineProperties(_, {\n\t\"register\": {\n\t\tvalue: function(id, config) {\n\t\t\tif (typeof arguments[0] === \"object\") {\n\t\t\t\t// Multiple definitions\n\t\t\t\tfor (let s in arguments[0]) {\n\t\t\t\t\t_.register(s, arguments[0][s]);\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (config.extend) {\n\t\t\t\tvar base = _[config.extend];\n\n\t\t\t\tconfig = $.extend($.extend({}, base, p => p != \"selector\"), config);\n\t\t\t}\n\n\t\t\tif (id.indexOf(\"@\") > -1) {\n\t\t\t\tvar parts = id.split(\"@\");\n\n\t\t\t\tconfig.selector = config.selector || parts[0] || \"*\";\n\n\t\t\t\tif (config.attribute === undefined) {\n\t\t\t\t\tconfig.attribute = parts[1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconfig.selector = config.selector || id;\n\t\t\tconfig.id = id;\n\n\t\t\tif (Array.isArray(config.attribute)) {\n\t\t\t\tfor (var attribute of config.attribute) {\n\t\t\t\t\to = $.extend({}, config);\n\t\t\t\t\to.attribute = attribute;\n\n\t\t\t\t\t_[`${id}@${attribute}`] = o;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\n\t\t\t\t_[id] = config;\n\t\t\t}\n\n\t\t\treturn _;\n\t\t}\n\t},\n\t\"search\": {\n\t\tvalue: function(element, attribute, datatype) {\n\t\t\tvar matches = _.matches(element, attribute, datatype);\n\n\t\t\treturn matches[matches.length - 1] || { attribute };\n\t\t}\n\t},\n\t\"matches\": {\n\t\tvalue: function(element, attribute, datatype) {\n\t\t\tvar matches = [];\n\n\t\t\tselectorloop: for (var id in _) {\n\t\t\t\tvar o = _[id];\n\n\t\t\t\t// Passes attribute test?\n\t\t\t\tvar attributeMatches = attribute === undefined && o.default || attribute === o.attribute;\n\n\t\t\t\tif (!attributeMatches) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Passes datatype test?\n\t\t\t\tif (datatype !== undefined && datatype !== \"string\" && datatype !== o.datatype) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Passes selector test?\n\t\t\t\tvar selector = o.selector || id;\n\t\t\t\tif (!element.matches(selector)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Passes arbitrary test?\n\t\t\t\tif (o.test && !o.test(element, attribute, datatype)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// All tests have passed\n\t\t\t\tmatches.push(o);\n\t\t\t}\n\n\t\t\treturn matches;\n\t\t}\n\t},\n\n\tisSVG: {\n\t\tvalue: e => e.namespaceURI == \"http://www.w3.org/2000/svg\"\n\t},\n\n\tdefaultEditors: {\n\t\tvalue: {\n\t\t\t\"string\":  { tag: \"input\" },\n\t\t\t\"number\":  { tag: \"input\", type: \"number\" },\n\t\t\t\"boolean\": { tag: \"input\", type: \"checkbox\" }\n\t\t}\n\t}\n});\n\n_.register({\n\t\"@hidden\": {\n\t\tdatatype: \"boolean\"\n\t},\n\n\t\"@y\": {\n\t\ttest: _.isSVG,\n\t\tdatatype: \"number\"\n\t},\n\n\t\"@x\": {\n\t\tdefault: true,\n\t\ttest: _.isSVG,\n\t\tdatatype: \"number\"\n\t},\n\n\t\"media\": {\n\t\tdefault: true,\n\t\tselector: \"img, video, audio\",\n\t\tattribute: \"src\",\n\t\teditor: function() {\n\t\t\tvar uploadBackend = this.mavo.storage && this.mavo.storage.upload? this.mavo.storage : this.uploadBackend;\n\n\t\t\tvar mainInput = $.create(\"input\", {\n\t\t\t\t\"type\": \"url\",\n\t\t\t\t\"placeholder\": \"http://example.com/image.png\",\n\t\t\t\t\"className\": \"mv-output\",\n\t\t\t\t\"aria-label\": \"URL to image\"\n\t\t\t});\n\n\t\t\tif (uploadBackend && self.FileReader) {\n\t\t\t\tvar popup;\n\t\t\t\tvar type = this.element.nodeName.toLowerCase();\n\t\t\t\ttype = type == \"img\"? \"image\" : type;\n\t\t\t\tvar path = this.element.getAttribute(\"mv-uploads\") || type + \"s\";\n\n\t\t\t\tvar upload = (file, name = file.name) => {\n\t\t\t\t\tif (file && file.type.indexOf(type + \"/\") === 0) {\n\t\t\t\t\t\tthis.mavo.upload(file, path + \"/\" + name).then(url => {\n\t\t\t\t\t\t\tmainInput.value = url;\n\t\t\t\t\t\t\t$.fire(mainInput, \"input\");\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tvar uploadEvents = {\n\t\t\t\t\t\"paste\": evt => {\n\t\t\t\t\t\tvar item = evt.clipboardData.items[0];\n\n\t\t\t\t\t\tif (item.kind == \"file\" && item.type.indexOf(type + \"/\") === 0) {\n\t\t\t\t\t\t\t// Is a file of the correct type, upload!\n\t\t\t\t\t\t\tvar name = `pasted-${type}-${Date.now()}.${item.type.slice(6)}`; // image, video, audio are all 5 chars\n\t\t\t\t\t\t\tupload(item.getAsFile(), name);\n\t\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t\"drag dragstart dragend dragover dragenter dragleave drop\": evt => {\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t\t},\n\t\t\t\t\t\"dragover dragenter\": evt => {\n\t\t\t\t\t\tpopup.classList.add(\"mv-dragover\");\n\t\t\t\t\t\tthis.element.classList.add(\"mv-dragover\");\n\t\t\t\t\t},\n\t\t\t\t\t\"dragleave dragend drop\": evt => {\n\t\t\t\t\t\tpopup.classList.remove(\"mv-dragover\");\n\t\t\t\t\t\tthis.element.classList.remove(\"mv-dragover\");\n\t\t\t\t\t},\n\t\t\t\t\t\"drop\": evt => {\n\t\t\t\t\t\tupload(evt.dataTransfer.files[0]);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t$.events(this.element, uploadEvents);\n\n\t\t\t\treturn popup = $.create({\n\t\t\t\t\tclassName: \"mv-upload-popup\",\n\t\t\t\t\tcontents: [\n\t\t\t\t\t\tmainInput, {\n\t\t\t\t\t\t\ttag: \"input\",\n\t\t\t\t\t\t\ttype: \"file\",\n\t\t\t\t\t\t\t\"aria-label\": \"Upload image\",\n\t\t\t\t\t\t\taccept: type + \"/*\",\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tchange: evt => {\n\t\t\t\t\t\t\t\t\tvar file = evt.target.files[0];\n\n\t\t\t\t\t\t\t\t\tif (!file) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tupload(file);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tclassName: \"mv-tip\",\n\t\t\t\t\t\t\tinnerHTML: \"<strong>Tip:</strong> You can also drag & drop or paste!\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tevents: uploadEvents\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn mainInput;\n\t\t\t}\n\t\t}\n\t},\n\n\t\"video, audio\": {\n\t\tattribute: [\"autoplay\", \"buffered\", \"loop\"],\n\t\tdatatype: \"boolean\"\n\t},\n\n\t\"a, link\": {\n\t\tdefault: true,\n\t\tattribute: \"href\"\n\t},\n\n\t\"input, select, button, textarea\": {\n\t\tattribute: \"disabled\",\n\t\tdatatype: \"boolean\"\n\t},\n\n\t\"formControl\": {\n\t\tselector: \"select, input\",\n\t\tdefault: true,\n\t\tattribute: \"value\",\n\t\tmodes: \"edit\",\n\t\tchangeEvents: \"input change\",\n\t\tedit: () => {},\n\t\tdone: () => {},\n\t\tinit: function() {\n\t\t\tthis.editor = this.element;\n\t\t}\n\t},\n\n\t\"textarea\": {\n\t\textend: \"formControl\",\n\t\tattribute: null,\n\t\tgetValue: element => element.value,\n\t\tsetValue: (element, value) => element.value = value\n\t},\n\n\t\"formNumber\": {\n\t\textend: \"formControl\",\n\t\tselector: \"input[type=range], input[type=number]\",\n\t\tdatatype: \"number\"\n\t},\n\n\t\"checkbox\": {\n\t\textend: \"formControl\",\n\t\tselector: \"input[type=checkbox]\",\n\t\tattribute: \"checked\",\n\t\tdatatype: \"boolean\",\n\t\tchangeEvents: \"click\"\n\t},\n\n\t\"input[type=radio]\": {\n\t\textend: \"formControl\",\n\t\tattribute: \"checked\",\n\t\tmodes: \"edit\",\n\t\tgetValue: element => {\n\t\t\tif (element.form) {\n\t\t\t\treturn element.form[element.name].value;\n\t\t\t}\n\n\t\t\tvar checked = $(`input[type=radio][name=\"${element.name}\"]:checked`);\n\t\t\treturn checked && checked.value;\n\t\t},\n\t\tsetValue: (element, value) => {\n\t\t\tif (element.form) {\n\t\t\t\telement.form[element.name].value = value;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar toCheck = $(`input[type=radio][name=\"${element.name}\"][value=\"${value}\"]`);\n\t\t\t$.properties(toCheck, {checked: true});\n\t\t},\n\t\tinit: function(element) {\n\t\t\tthis.mavo.element.addEventListener(\"change\", evt => {\n\t\t\t\tif (evt.target.name == element.name) {\n\t\t\t\t\tthis.value = this.getValue();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t\"counter\": {\n\t\textend: \"formControl\",\n\t\tselector: \"button, .counter\",\n\t\tattribute: \"mv-clicked\",\n\t\tdatatype: \"number\",\n\t\tinit: function(element) {\n\t\t\tif (this.attribute === \"mv-clicked\") {\n\t\t\t\telement.setAttribute(\"mv-clicked\", \"0\");\n\n\t\t\t\telement.addEventListener(\"click\", evt => {\n\t\t\t\t\tlet clicked = +element.getAttribute(\"mv-clicked\") || 0;\n\t\t\t\t\tthis.value = ++clicked;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\n\t\"meter, progress\": {\n\t\tdefault: true,\n\t\tattribute: \"value\",\n\t\tdatatype: \"number\",\n\t\tedit: function() {\n\t\t\tvar min = +this.element.getAttribute(\"min\") || 0;\n\t\t\tvar max = +this.element.getAttribute(\"max\") || 1;\n\t\t\tvar range = max - min;\n\t\t\tvar step = +this.element.getAttribute(\"mv-edit-step\") || (range > 1? 1 : range/100);\n\n\t\t\tthis.element.addEventListener(\"mousemove.mavo:edit\", evt => {\n\t\t\t\t// Change property as mouse moves\n\t\t\t\tvar left = this.element.getBoundingClientRect().left;\n\t\t\t\tvar offset = Math.max(0, (evt.clientX - left) / this.element.offsetWidth);\n\t\t\t\tvar newValue = min + range * offset;\n\t\t\t\tvar mod = newValue % step;\n\n\t\t\t\tnewValue += mod > step/2? step - mod : -mod;\n\t\t\t\tnewValue = Math.max(min, Math.min(newValue, max));\n\n\t\t\t\tthis.sneak(() => this.element.setAttribute(\"value\", newValue));\n\t\t\t});\n\n\t\t\tthis.element.addEventListener(\"mouseleave.mavo:edit\", evt => {\n\t\t\t\t// Return to actual value\n\t\t\t\tthis.sneak(() => this.element.setAttribute(\"value\", this.value));\n\t\t\t});\n\n\t\t\tthis.element.addEventListener(\"click.mavo:edit\", evt => {\n\t\t\t\t// Register change\n\t\t\t\tthis.value = this.getValue();\n\t\t\t});\n\n\t\t\tthis.element.addEventListener(\"keydown.mavo:edit\", evt => {\n\t\t\t\t// Edit with arrow keys\n\t\t\t\tif (evt.target == this.element && (evt.keyCode == 37 || evt.keyCode == 39)) {\n\t\t\t\t\tvar increment = step * (evt.keyCode == 39? 1 : -1) * (evt.shiftKey? 10 : 1);\n\t\t\t\t\tvar newValue = this.value + increment;\n\t\t\t\t\tnewValue = Math.max(min, Math.min(newValue, max));\n\n\t\t\t\t\tthis.element.setAttribute(\"value\", newValue);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tdone: function() {\n\t\t\t$.unbind(this.element, \".mavo:edit\");\n\t\t}\n\t},\n\n\t\"meta\": {\n\t\tdefault: true,\n\t\tattribute: \"content\"\n\t},\n\n\t\"block\": {\n\t\tdefault: true,\n\t\tselector: \"p, div, li, dt, dd, h1, h2, h3, h4, h5, h6, article, section, address\",\n\t\teditor: function() {\n\t\t\tvar display = getComputedStyle(this.element).display;\n\t\t\tvar tag = display.indexOf(\"inline\") === 0? \"input\" : \"textarea\";\n\t\t\tvar editor = $.create(tag);\n\n\t\t\tif (tag == \"textarea\") {\n\t\t\t\t// Actually multiline\n\t\t\t\tvar width = this.element.offsetWidth;\n\n\t\t\t\tif (width) {\n\t\t\t\t\teditor.width = width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn editor;\n\t\t},\n\n\t\tsetEditorValue: function(value) {\n\t\t\tif (this.datatype && this.datatype != \"string\") {\n\t\t\t\tvalue = value + \"\";\n\t\t\t}\n\n\t\t\tvar cs = getComputedStyle(this.element);\n\t\t\tvalue = value || \"\";\n\n\t\t\tif ([\"normal\", \"nowrap\"].indexOf(cs.whiteSpace) > -1) {\n\t\t\t\t// Collapse lines\n\t\t\t\tvalue = value.replace(/\\r?\\n/g, \" \");\n\t\t\t}\n\n\t\t\tif ([\"normal\", \"nowrap\", \"pre-line\"].indexOf(cs.whiteSpace) > -1) {\n\t\t\t\t// Collapse whitespace\n\t\t\t\tvalue = value.replace(/^[ \\t]+|[ \\t]+$/gm, \"\").replace(/[ \\t]+/g, \" \");\n\t\t\t}\n\n\t\t\tthis.editor.value = value;\n\t\t\treturn true;\n\t\t}\n\t},\n\n\t\"time\": {\n\t\tattribute: \"datetime\",\n\t\tdefault: true,\n\t\tinit: function() {\n\t\t\tthis.element.setAttribute(\"mv-label\", this.label);\n\n\t\t\tif (!this.fromTemplate(\"dateType\")) {\n\t\t\t\tvar dateFormat = Mavo.DOMExpression.search(this.element, null);\n\n\t\t\t\tvar datetime = this.element.getAttribute(\"datetime\") || \"YYYY-MM-DD\";\n\n\t\t\t\tfor (var type in this.config.dateTypes) {\n\t\t\t\t\tif (this.config.dateTypes[type].test(datetime)) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.dateType = type;\n\n\t\t\t\tif (!dateFormat) {\n\t\t\t\t\t// TODO what about mv-expressions?\n\t\t\t\t\tthis.element.textContent = this.config.defaultFormats[this.dateType](this.property);\n\t\t\t\t\tthis.mavo.expressions.extract(this.element, null);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdateTypes: {\n\t\t\t\"date\": /^[Y\\d]{4}-[M\\d]{2}-[D\\d]{2}$/i,\n\t\t\t\"month\": /^[Y\\d]{4}-[M\\d]{2}$/i,\n\t\t\t\"time\": /^[H\\d]{2}:[M\\d]{2}/i,\n\t\t\t\"datetime-local\": /^[Y\\d]{4}-[M\\d]{2}-[D\\d]{2} [H\\d]{2}:[M\\d]{2}/i\n\t\t},\n\t\tdefaultFormats: {\n\t\t\t\"date\": property => `[day(${property})] [month(${property}).shortname] [year(${property})]`,\n\t\t\t\"month\": property => `[month(${property}).name] [year(${property})]`,\n\t\t\t\"time\": property => `[hour(${property})]:[minute(${property})]`,\n\t\t\t\"datetime-local\": property => `[day(${property})] [month(${property}).shortname] [year(${property})]`\n\t\t},\n\t\teditor: function() {\n\t\t\treturn {tag: \"input\", type: this.dateType};\n\t\t}\n\t},\n\n\t\"circle@r\": {\n\t\tdefault: true,\n\t\tdatatype: \"number\"\n\t},\n\n\t\"circle\": {\n\t\tattribute: [\"cx\", \"cy\"],\n\t\tdatatype: \"number\"\n\t},\n\n\t\"text\": {\n\t\tdefault: true,\n\t\tpopup: true\n\t},\n\n\t\"[role=checkbox]\": {\n\t\tdefault: true,\n\t\tattribute: \"aria-checked\",\n\t\tdatatype: \"boolean\",\n\t\tedit: function() {\n\t\t\tthis.element.addEventListener(\"click.mavo:edit\", evt => {\n\t\t\t\tthis.value = !this.value;\n\t\t\t\tevt.preventDefault();\n\t\t\t});\n\t\t},\n\t\tdone: function() {\n\t\t\t$.unbind(this.element, \".mavo:edit\");\n\t\t}\n\t}\n});\n\n})(Bliss, Bliss.$);\n"]}